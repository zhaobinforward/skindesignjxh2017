var dataForShare = {
	/*搜狗输入法手机皮肤创意大赛*/
	title:'\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b',
	/*#搜狗输入法手机皮肤创意大赛# 十万壕礼征集手机皮肤！原来小键盘也可以有大设计~我在搜狗输入法手机皮肤创意大赛上看到【作者名】设计的【皮肤名】帅翻天，快来点赞分享吧！@搜狗输入法*/
	content:'#\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b# \u5341\u4e07\u58d5\u793c\u5f81\u96c6\u624b\u673a\u76ae\u80a4\uff01\u539f\u6765\u5c0f\u952e\u76d8\u4e5f\u53ef\u4ee5\u6709\u5927\u8bbe\u8ba1~\u6211\u5728\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b\u4e0a\u770b\u5230\u3010{author_name}\u3011\u8bbe\u8ba1\u7684\u3010{skin_name}\u3011\u5e05\u7ffb\u5929\uff0c\u5feb\u6765\u70b9\u8d5e\u5206\u4eab\u5427\uff01@\u641c\u72d7\u8f93\u5165\u6cd5',
	imgurl:'http://shouji.sogou.com/sapp/skindesign2016/static/i/share_wb.png',
	contenturl:'http://shouji.sogou.com/sapp/skindesign2016/?f=weibo'
}
var dataForShare2 = {
	title:dataForShare.title,
	/*#搜狗输入法手机皮肤创意大赛# 十万壕礼征集手机皮肤！我在搜狗输入法手机皮肤创意大赛上看到【作者名】设计的【皮肤名】获得【】奖，快来点赞分享吧！@搜狗输入法*/
	content:'#\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b# \u5341\u4e07\u58d5\u793c\u5f81\u96c6\u624b\u673a\u76ae\u80a4\uff01\u6211\u5728\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b\u4e0a\u770b\u5230\u3010{author_name}\u3011\u8bbe\u8ba1\u7684\u3010{skin_name}\u3011\u83b7\u5f97\u3010{grade}\u3011\u5956\uff0c\u5feb\u6765\u70b9\u8d5e\u5206\u4eab\u5427\uff01@\u641c\u72d7\u8f93\u5165\u6cd5',
	imgurl:dataForShare.imgurl,
	contenturl:dataForShare.contenturl
}

var dataForQzoneShare = {
	/*搜狗输入法手机皮肤创意大赛*/
	title:'\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b',
	/*十万壕礼征集搜狗输入法手机皮肤！我在搜狗输入法手机皮肤创意大赛上看到【作者名】设计的【皮肤名】帅翻天，快来点赞分享吧！@搜狗输入法*/
	content:'\u5341\u4e07\u58d5\u793c\u5f81\u96c6\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\uff01\u6211\u5728\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b\u4e0a\u770b\u5230\u3010{author_name}\u3011\u8bbe\u8ba1\u7684\u3010{skin_name}\u3011\u5e05\u7ffb\u5929\uff0c\u5feb\u6765\u70b9\u8d5e\u5206\u4eab\u5427\uff01@\u641c\u72d7\u8f93\u5165\u6cd5',
	imgurl:'http://shouji.sogou.com/sapp/skindesign2016/static/i/share_wb.png',
	contenturl:'http://shouji.sogou.com/sapp/skindesign2016/?f=weibo'
}
var dataForQzoneShare2 = {
	title:dataForQzoneShare.title,
	/*十万壕礼征集搜狗输入法手机皮肤！我在搜狗输入法手机皮肤创意大赛上看到【作者名】设计的【皮肤名】获得【】奖，快来点赞分享吧！@搜狗输入法*/
	content:'\u5341\u4e07\u58d5\u793c\u5f81\u96c6\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\uff01\u6211\u5728\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b\u4e0a\u770b\u5230\u3010{author_name}\u3011\u8bbe\u8ba1\u7684\u3010{skin_name}\u3011\u83b7\u5f97\u3010{grade}\u3011\u5956\uff0c\u5feb\u6765\u70b9\u8d5e\u5206\u4eab\u5427\uff01@\u641c\u72d7\u8f93\u5165\u6cd5',
	imgurl:dataForQzoneShare.imgurl,
	contenturl:dataForQzoneShare.contenturl
}

var dataForWeixinShare = {
	/*搜狗输入法手机皮肤创意大赛*/
	title:'\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b',
	/*#搜狗输入法手机皮肤创意大赛# 十万壕礼征集手机皮肤！原来小键盘也可以有大设计~我在搜狗输入法手机皮肤创意大赛上看到【作者名】设计的【皮肤名】帅翻天，快来点赞分享吧！@搜狗输入法*/
	content:'#\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b# \u5341\u4e07\u58d5\u793c\u5f81\u96c6\u624b\u673a\u76ae\u80a4\uff01\u539f\u6765\u5c0f\u952e\u76d8\u4e5f\u53ef\u4ee5\u6709\u5927\u8bbe\u8ba1~\u6211\u5728\u641c\u72d7\u8f93\u5165\u6cd5\u624b\u673a\u76ae\u80a4\u521b\u610f\u5927\u8d5b\u4e0a\u770b\u5230\u3010{author_name}\u3011\u8bbe\u8ba1\u7684\u3010{skin_name}\u3011\u5e05\u7ffb\u5929\uff0c\u5feb\u6765\u70b9\u8d5e\u5206\u4eab\u5427\uff01@\u641c\u72d7\u8f93\u5165\u6cd5',
	imgurl:'http://shouji.sogou.com/sapp/skindesign2016/static/i/share.png',
	contenturl:'http://shouji.sogou.com/sapp/skindesign2016/?f=weixin'
}


var dataForShareTmp = {};
var dataForQzoneShareTmp = {};
var dataForWeixinShareTmp = {};

function get_skin_byid(id) {
	var id = isUndefined(id) ? 0 : id;
	var skin = {};
	if(id < 1) {
		return skin;
	}
	var skins = window['skins'] || [];
	for(var i=0;i<skins.length;i++) {
		if(skins[i].id == id) {
			skin = skins[i];
			break;
		}
	}
	return skin;
}

function show_share(id, grade) {
	pb_count('btn_share_total');
	var grade = typeof grade == 'undefined' ? 0 : grade;
	var skin = get_skin_byid(id);
	if($.isEmptyObject(skin)) {
		return;
	}
	setTimeout(function(){pb_count('btn_share_skinid_'+skin.id)},250);
	
	if(grade == 0) {
		dataForShareTmp = $.extend(dataForShareTmp, dataForShare);
		dataForShareTmp.content = dataForShareTmp.content.replace('{author_name}', skin.author_name).replace('{skin_name}', skin.skin_name);
		dataForShareTmp.imgurl = skin.pickey26;
		
		dataForQzoneShareTmp = $.extend(dataForQzoneShareTmp, dataForQzoneShare);
		dataForQzoneShareTmp.content = dataForQzoneShareTmp.content.replace('{author_name}', skin.author_name).replace('{skin_name}', skin.skin_name);
		dataForQzoneShareTmp.imgurl = skin.pickey26;
	} else {
		
		//var map = ['','','','','','优秀','最佳创意','最佳体验','三等','二等','一等'];
		var map = ['','','','','','\u4f18\u79c0','\u6700\u4f73\u521b\u610f','\u6700\u4f73\u4f53\u9a8c','\u4e09\u7b49','\u4e8c\u7b49','\u4e00\u7b49'];
		
		dataForShareTmp = $.extend(dataForShareTmp, dataForShare2);
		dataForShareTmp.content = dataForShareTmp.content.replace('{author_name}', skin.author_name).replace('{skin_name}', skin.skin_name).replace('{grade}', map[grade]);
		dataForShareTmp.imgurl = skin.pickey26;
		
		dataForQzoneShareTmp = $.extend(dataForQzoneShareTmp, dataForQzoneShare2);
		dataForQzoneShareTmp.content = dataForQzoneShareTmp.content.replace('{author_name}', skin.author_name).replace('{skin_name}', skin.skin_name).replace('{grade}', map[grade]);
		dataForQzoneShareTmp.imgurl = skin.pickey26;
	}
	
	$('#share_pop').appendTo('body').show();
}
function share_weibo() {
	pb_count('btn_share_weibo');
	var _t = dataForShareTmp.content+' '+dataForShareTmp.contenturl;
	window.open('http://v.t.sina.com.cn/share/share.php?title='+encodeURIComponent(_t)+'&pic='+encodeURIComponent(dataForShareTmp.imgurl)+'&source=bookmark','_blank','width=450,height=400');
}
function share_qzone() {
	pb_count('btn_share_qzone');
	var p = {
		url: dataForQzoneShareTmp.contenturl,
		showcount: '0', /*是否显示分享总数,显示：'1'，不显示：'0' */
		desc: '', /*默认分享理由(可选)*/
		summary: dataForQzoneShareTmp.content, /*分享摘要(可选)*/
		title: dataForQzoneShareTmp.title, /*分享标题(可选)*/
		site: '\u641c\u72d7\u8f93\u5165\u6cd5', /*分享来源 如：腾讯网(可选)*/
		pics: dataForQzoneShareTmp.imgurl, /*分享图片的路径(可选)*/
		style: '203',
		width: 22,
		height: 22
	};
	var s = [];
	for (var i in p) {
		s.push(i + '=' + encodeURIComponent(p[i] || ''));
	}
	window.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?'+s.join('&'),'_blank','width=450,height=400');
}
function bindShare(dataForShare) {
	var title = dataForShare.title;
	var desc = dataForShare.content;
	var link = dataForShare.contenturl;
	var imgUrl = dataForShare.imgurl;
	wx.onMenuShareTimeline({
		title: desc,
		link: link,
		imgUrl: imgUrl,
		success: function (res) {
			pb_count('share_weixin_timeline_succ');
		},
		cancel: function (res) {
			pb_count('share_weixin_timeline_cancel');
		},
		fail: function (res) {
			pb_count('share_weixin_timeline_fail');
		}
	});
	wx.onMenuShareAppMessage({
		title: title,
		desc: desc,
		link: link,
		imgUrl: imgUrl,
		success: function (res) {
			pb_count('share_weixin_appmes_succ');
		},
		cancel: function (res) {
			pb_count('share_weixin_appmes_cancel');
		},
		fail: function (res) {
			pb_count('share_weixin_appmes_fail');
		}
	});
	wx.onMenuShareQQ({
		title: title,
		desc: desc,
		link: link,
		imgUrl: imgUrl,
		success: function (res) {
		},
		cancel: function (res) {
		},
		fail: function (res) {
		}
	});
	wx.onMenuShareWeibo({
		title: title,
		desc: desc,
		link: link,
		imgUrl: imgUrl,
		success: function (res) {    
		},
		cancel: function (res) {
		},
		fail: function (res) {
		}
	});
}
$(function(){
	dataForShareTmp = $.extend(dataForShareTmp, dataForShare);
	dataForQzoneShareTmp = $.extend(dataForQzoneShareTmp, dataForQzoneShare);
	dataForWeixinShareTmp = $.extend(dataForWeixinShareTmp, dataForWeixinShare);
	if(isWeiXin()) {
		appendscript('http://res.wx.qq.com/open/js/jweixin-1.0.0.js', '', function(){
			appendscript('http://shouji.sogou.com/api/weixin/jssdk/wxconfig.php?rurl='+encodeURIComponent(document.location.href), '', function(){
				var wxconfig = window['wxconfig'] || '';
				if(wxconfig) {
					wx.config({
						appId: wxconfig.appId,
						timestamp: wxconfig.timestamp,
						nonceStr: wxconfig.nonceStr,
						signature: wxconfig.signature,
						jsApiList: [
							'onMenuShareTimeline',
							'onMenuShareAppMessage',
							'onMenuShareQQ',
							'onMenuShareWeibo'
						]
					});
					wx.ready(function () {
						bindShare(dataForWeixinShareTmp);
					});
				}
			});
		});
	}
});